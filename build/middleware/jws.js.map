{"version":3,"file":"jws.js","sourceRoot":"","sources":["../../src/middleware/jws.ts"],"names":[],"mappings":";;AAIA,oDAaC;AAED,oDAQC;AAED,4BAEC;AA/BD,+CAA2C;AAC3C,0CAA8C;AAC9C,gDAAgD;AAEhD,SAAgB,oBAAoB,CAAC,KAAU;IAC7C,IAAI,CAAC,KAAK;QAAE,OAAO,IAAI,CAAC;IACxB,OAAO,IAAA,mBAAI,EAAC;QACV,MAAM,EAAE,KAAK,CAAC,MAAM;QACpB,MAAM,EAAE,KAAK,CAAC,MAAM;QACpB,UAAU,EAAE,KAAK,CAAC,UAAU;QAC5B,SAAS,EAAE,KAAK,CAAC,SAAS;QAC1B,cAAc,EAAE,KAAK,CAAC,cAAc;QACpC,OAAO,EAAE,KAAK,CAAC,OAAO;KACvB,EACC,uBAAc,EACd,EAAE,SAAS,EAAE,IAAI,EAAE,CACpB,CAAA;AACH,CAAC;AAED,SAAgB,oBAAoB,CAAC,MAAc;IACjD,IAAI,CAAC,MAAM;QAAE,OAAO,IAAI,CAAC;IACzB,OAAO,IAAA,mBAAI,EAAC;QACV,MAAM,EAAE,MAAM;KACf,EACC,uBAAc,EACd,EAAE,SAAS,EAAE,KAAK,EAAE,CACrB,CAAA;AACH,CAAC;AAED,SAAgB,QAAQ,CAAC,KAAU;IACjC,OAAO,IAAA,qBAAM,EAAC,KAAK,EAAE,uBAAc,CAAW,CAAA;AAChD,CAAC","sourcesContent":["import { sign, verify } from 'jsonwebtoken'\r\nimport { SECRET_JWT_KEY } from '../env/config'\r\n// import { UserData } from '../interface/users'\r\n\r\nexport function JWTMiddlewareInitial(input: any) {\r\n  if (!input) return null;\r\n  return sign({\r\n    cedula: input.cedula,\r\n    correo: input.correo,\r\n    imagen_url: input.imagen_url,\r\n    localidad: input.localidad,\r\n    nombre_usuario: input.nombre_usuario,\r\n    nombres: input.nombres\r\n  },\r\n    SECRET_JWT_KEY,\r\n    { expiresIn: '1h' }\r\n  )\r\n}\r\n\r\nexport function JWTMiddlewareRefresh(cedula: number) {\r\n  if (!cedula) return null;\r\n  return sign({\r\n    cedula: cedula\r\n  },\r\n    SECRET_JWT_KEY,\r\n    { expiresIn: '30d' }\r\n  )\r\n}\r\n\r\nexport function JWTParse(input: any) {\r\n  return verify(input, SECRET_JWT_KEY) as object\r\n}"]}