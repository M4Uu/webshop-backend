{"version":3,"file":"cors.js","sourceRoot":"","sources":["../../src/middleware/cors.ts"],"names":[],"mappings":";;;;;;AAAA,gDAAuB;AAEvB,MAAM,gBAAgB,GAAG;IACvB,uBAAuB;IACvB,uBAAuB;IACvB,uBAAuB;IACvB,kCAAkC;IAClC,sCAAsC;CACvC,CAAA;AAEM,MAAM,cAAc,GAAG,CAAC,EAAE,eAAe,GAAG,gBAAgB,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,IAAA,cAAI,EAAC;IAClF,MAAM,EAAE,CAAC,MAA0B,EAAE,QAAQ,EAAE,EAAE;QAC/C,kEAAkE;QAClE,IAAI,CAAC,MAAM;YAAE,OAAO,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;QAEzC,2CAA2C;QAC3C,MAAM,gBAAgB,GAAG,MAAM,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;QACjE,MAAM,kBAAkB,GAAG,eAAe,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC,CAAC;QAExF,6CAA6C;QAC7C,IAAI,kBAAkB,CAAC,QAAQ,CAAC,gBAAgB,CAAC,EAAE,CAAC;YAClD,OAAO,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;QAC9B,CAAC;QAED,uCAAuC;QACvC,OAAO,QAAQ,CAAC,IAAI,KAAK,CAAC,WAAW,MAAM,yBAAyB,CAAC,CAAC,CAAC;IACzE,CAAC;IACD,OAAO,EAAE,CAAC,KAAK,EAAE,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,SAAS,CAAC;IACtD,cAAc,EAAE,CAAC,cAAc,EAAE,eAAe,CAAC;IACjD,WAAW,EAAE,IAAI;CAClB,CAAC,CAAA;AApBW,QAAA,cAAc,kBAoBzB","sourcesContent":["import cors from 'cors'\r\n\r\nconst ACCEPTED_ORIGINS = [\r\n  'http://localhost:1234',\r\n  'http://localhost:9876',\r\n  'http://localhost:4200',\r\n  'https://webshoptesis.netlify.app',\r\n  'https://www.webshoptesis.netlify.app'\r\n]\r\n\r\nexport const corsMiddleware = ({ acceptedOrigins = ACCEPTED_ORIGINS } = {}) => cors({\r\n  origin: (origin: string | undefined, callback) => {\r\n    // 1. Permitir solicitudes sin 'Origin' (mismo origen, curl, etc.)\r\n    if (!origin) return callback(null, true);\r\n\r\n    // 2. Normalizar el origen para comparación\r\n    const normalizedOrigin = origin.toLowerCase().replace(/\\/$/, '');\r\n    const normalizedAccepted = acceptedOrigins.map(o => o.toLowerCase().replace(/\\/$/, ''));\r\n\r\n    // 3. Verificar contra la lista de permitidos\r\n    if (normalizedAccepted.includes(normalizedOrigin)) {\r\n      return callback(null, true);\r\n    }\r\n\r\n    // 4. Rechazar todos los demás orígenes\r\n    return callback(new Error(`Origen '${origin}' no permitido por CORS`));\r\n  },\r\n  methods: ['GET', 'POST', 'PATCH', 'DELETE', 'OPTIONS'],\r\n  allowedHeaders: ['Content-Type', 'Authorization'],\r\n  credentials: true\r\n})"]}